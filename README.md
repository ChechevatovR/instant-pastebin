# Instant Pastebin

Что если бы скайп реально был файлообменником

---

Сервис для защищённой одноразовой передачи данных между устройствами, предоставляющий как простой веб-интерфейс, так и консольный интерфейс. Для обеспечения конфиденциальности используется peer-to-peer соединение. Сервис нацелен на скрытие передачи большого количества информации путем внесения непредсказуемых задержек, обычно не встречающихся в подобных системах. Задержки вносятся путем геймификации процесса передачи данных. 

[Презентация](https://docs.google.com/presentation/d/1G8DHwZHpTcCdhvrjacdG3FIfxm9SMt6qSFCvWKldfE4/edit?usp=sharing)

## Сборка

### Хранилище сессий

**Prerequisites:** установленные Rust тулчейн и Cargo. С инструкцией можно ознакомиться, например, [здесь](https://rustup.rs/)

В директории `backend` выполните команду `cargo run`. 

### CLI-клиент

**Prerequisites:** установленные Rust тулчейн и Cargo. С инструкцией можно ознакомиться, например, [здесь](https://rustup.rs/)

- Отправка: в директории `cli` выполните команду `cargo run -- --send <filename>`, где filename -- путь к файлу, который необходимо отправить
- Получение: в директории `cli` выполните команду `cargo run -- --receive <session-id>`, где session-id -- идентификатор сессии, полученный от отправителя

В коде клиента захардкожен адрес хранилища сессий. 
Если вы хотите использовать свой -- необходимо заменить адрес в исходном коде программы

### Web-клиент

**Prerequisites:** установленный npm. С инструкцией можно ознакомиться, например, [здесь](https://www.google.com/search?q=install+npm)

В директории `frontend` выполните команду `npm i` для установки зависимостей (достаточно сделать однократно).
После этого выполните `npx vite` для запуска веб-сервера

В коде клиента захардкожен адрес хранилища сессий.
Если вы хотите использовать свой -- необходимо заменить адрес в исходном коде программы

#### Сборка DOOM

**Prerequisites:** установленный `emscripten`, библиотеки `SDL2`, `SDL2_image`, `SDL2_ttf`.

В директории `frontend/games/wasmDOOM/src` выполнить `make`. Скопировать файлы из `frontend/games/wasmDOOM/public`:
- `shareware.wad` и `wasm/wasm-doom.wasm` в `frontend/public/doom/`
- `wasm/wasm-doom.js` в `frontend/src/doom/`

## Развертывание

Хранилище сессий должно быть доступно по префиксу `/api`. Собранный web-клиент должен быть доступен по пути `/`. Пример конфигурации `Caddy`, при том что web-клиент находится в `/var/www/html`:
```Caddyfile
instant-pb.ru {
        handle /api/* {
                uri strip_prefix api
                reverse_proxy localhost:3000
        }

        handle /* {
                root * /var/www/html
                file_server
        }
}
```
